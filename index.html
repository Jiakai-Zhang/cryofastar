<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="CryoFastAR delivers feed-forward cryo-EM ab initio reconstruction with foundation-model speed and accuracy.">
  <meta property="og:title" content="CryoFastAR: Fast Cryo-EM Ab Initio Reconstruction Made Easy"/>
  <meta property="og:description" content="3D cryo-EM reconstruction with foundation-model speedups, progressive training, and downloadable results."/>
  <meta property="og:url" content="https://jiakai-zhang.github.io/cryofastar/"/>
  <meta property="og:image" content="static/images/teaser.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>

  <meta name="twitter:title" content="CryoFastAR: Fast Cryo-EM Ab Initio Reconstruction Made Easy">
  <meta name="twitter:description" content="Foundation model for rapid cryo-EM pose estimation and reconstruction.">
  <meta name="twitter:image" content="static/images/teaser.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="keywords" content="Cryo-EM, ab initio reconstruction, pose estimation, foundation model, fast reconstruction">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>CryoFastAR: Fast Cryo-EM Ab Initio Reconstruction Made Easy</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cpolygon points='36 2 14 36 30 36 28 62 50 28 34 28 36 2' fill='%23f5c400' stroke='%23000000' stroke-width='4' stroke-linejoin='round'/%3E%3C/svg%3E">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="https://unpkg.com/3dmol@latest/build/3Dmol-min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">CryoFastAR: Fast Cryo-EM <i>Ab Initio</i> Reconstruction Made Easy</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">Accepted to ICCV 2025</span>
            </div>
            <div class="is-size-5 publication-authors">
              <span class="author-block"><a href="https://jiakai-zhang.github.io" target="_blank">Jiakai Zhang</a><sup>1,2</sup>,</span>
              <span class="author-block"><a href="https://scholar.google.com/citations?user=6D6uyxAAAAAJ&amp;hl=en" target="_blank">Shouchen Zhou</a><sup>1,2</sup>,</span>
              <span class="author-block"><a href="https://scholar.google.com/citations?hl=en&amp;user=gQy4BcYAAAAJ" target="_blank">Haizhao Dai</a><sup>1,2</sup>,</span>
              <span class="author-block"><a href="https://xinhangliu.com/" target="_blank">Xinhang Liu</a><sup>3</sup>,</span>
              <span class="author-block"><a href="https://peihaowang.github.io/" target="_blank">Peihao Wang</a><sup>4</sup>,</span>
              <span class="author-block"><a href="https://zhiwenfan.github.io/" target="_blank">Zhiwen Fan</a><sup>4</sup>,</span>
              <span class="author-block"><a href="https://orcid.org/0000-0003-4065-2540" target="_blank">Yuan Pei</a><sup>1</sup>,</span>
              <span class="author-block">and <a href="https://www.yu-jingyi.com/" target="_blank">Jingyi Yu</a><sup>1</sup></span>
            </div>
            <div class="is-size-6 publication-authors">
              <span class="author-block"><sup>1</sup>ShanghaiTech University</span>
              <span class="author-block"><sup>2</sup>Cellverse Co., Ltd.</span>
              <span class="author-block"><sup>3</sup>Hong Kong University of Science and Technology</span>
              <span class="author-block"><sup>4</sup>The University of Texas at Austin</span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <span class="link-block">
                  <a href="https://arxiv.org/pdf/2506.05864v1.pdf" target="_blank"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2506.05864" target="_blank"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://github.com/Cellverse/CryoFastAR" target="_blank"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="item">
        <p class="teaser-tldr has-text-centered">
          <b>TL;DR:</b> CryoFastAR turns noisy cryo-EM particle stacks into high-fidelity <i>ab initio</i> reconstructions with a single feed-forward pass—no iterative pose search or estimation required.
        </p>
        <img src="static/images/teaser.png" alt="CryoFastAR overview illustration showing feed-forward cryo-EM reconstruction." class="center-image"/>
        <h2 class="subtitle has-text-justified">
          <b>CryoFastAR performs feed-forward pose estimation and reconstruction.</b>
          By leveraging multi-view integration and progressive training on large-scale simulated cryo-EM data, CryoFastAR predicts particle poses directly and dramatically accelerates <i>ab initio</i> reconstruction compared with iterative solvers.
        </h2>
      </div>
    </div>
  </section>

  <section class="section hero is-light">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Pose estimation from unordered images is fundamental for 3D reconstruction, robotics, and scientific imaging. Recent geometric foundation models enable end-to-end dense 3D reconstruction but remain underexplored for cryo-electron microscopy (cryo-EM), where reconstruction still depends on slow iterative optimization. We introduce CryoFastAR, the first geometric foundation model that directly predicts poses from cryo-EM particle images for fast <i>ab initio</i> reconstruction. CryoFastAR integrates multi-view features and is trained on large-scale simulated cryo-EM data with realistic noise and CTF modulation. A progressive training strategy stabilizes learning by starting from simplified settings before gradually increasing difficulty. Experiments on synthetic and real datasets show that CryoFastAR matches or exceeds reconstruction quality while significantly accelerating inference compared with traditional pipelines. Code, models, and datasets are released to spur further research.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero is-small is-light" id="video">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <h2 class="title is-3 has-text-centered">Demo Video (Coming Soon)</h2>
        <div class="columns is-centered has-text-centered">
          <div class="column is-four-fifths">
            <div class="publication-video">
              <div class="video-placeholder">
                <span class="video-placeholder-text">Demo video placeholder — replace with final recording.</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero is-small">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="content">
          <h2 class="title is-3">Interactive Volume Renderer</h2>
          <p>
            Explore CryoFastAR reconstructions directly in the browser. The viewer below renders volumetric density maps (MRC/CCP4/MAP) using GPU-based isosurfaces.
            Load the bundled sample volume or drag-and-drop your own files to inspect reconstructions interactively.
          </p>
          <div class="buttons is-centered volume-preset-buttons">
            <button class="button is-light volume-preset-button is-selected" data-volume-path="static/data/sample_map.ccp4" data-volume-format="ccp4" data-volume-label="sample_map.ccp4">
              Sample CCP4
            </button>
            <button class="button is-light volume-preset-button" data-volume-path="static/data/synthetic.mrc" data-volume-format="mrc" data-volume-label="synthetic.mrc">
              Synthetic MRC
            </button>
            <button class="button is-light volume-preset-button" data-volume-path="static/data/real.mrc" data-volume-format="mrc" data-volume-label="real.mrc">
              Real MRC
            </button>
          </div>
          <div class="file has-name is-centered volume-file-input">
            <label class="file-label">
              <input class="file-input" type="file" id="mrc-file-input" accept=".mrc,.map,.ccp4,.mrc.gz,.map.gz,.ccp4.gz">
              <span class="file-cta">
                <span class="file-icon">
                  <i class="fas fa-upload"></i>
                </span>
                <span class="file-label">
                  上传或替换体数据…
                </span>
              </span>
              <span class="file-name" id="mrc-file-name">sample_map.ccp4</span>
            </label>
          </div>
          <div id="volume-viewer" class="volume-viewer"></div>
          <p class="has-text-grey is-size-7 volume-hint">
            双击重置视角。上传新的体数据时，我们会自动推断扩展名（未压缩 MRC/MAP/CCP4）。如需 gzip 压缩，请先解压。
          </p>
          <p class="is-size-6" id="volume-status"></p>
        </div>
      </div>
    </div>
  </section>

  <script>
    (function () {
      function detectFormat(name) {
        const lowered = name.toLowerCase();
        if (lowered.endsWith('.ccp4')) return 'ccp4';
        if (lowered.endsWith('.map')) return 'ccp4';
        if (lowered.endsWith('.mrc')) return 'mrc';
        return 'ccp4';
      }

      function setStatus(message, isError) {
        const statusEl = document.getElementById('volume-status');
        if (!statusEl) return;
        statusEl.textContent = message || '';
        statusEl.className = isError ? 'has-text-danger' : 'has-text-grey';
      }

      document.addEventListener('DOMContentLoaded', function () {
        const container = document.getElementById('volume-viewer');
        if (!container) {
          return;
        }
        if (typeof $3Dmol === 'undefined') {
          setStatus('3Dmol.js 未正确加载，无法创建体数据查看器。', true);
          return;
        }

        const viewer = $3Dmol.createViewer(container, { backgroundColor: '#ffffff' });

        function clamp(value, min, max) {
          return Math.min(Math.max(value, min), max);
        }

        function computeIsoLevels(voldata) {
          const data = voldata?.data || voldata?.values;
          if (!data || !data.length) {
            return {
              pos: 1.0,
              neg: -1.0,
              min: 0,
              max: 0,
              mean: 0,
              sigma: 0
            };
          }

          let min = Infinity;
          let max = -Infinity;
          let sum = 0;
          let count = 0;
          for (let i = 0; i < data.length; i++) {
            const v = data[i];
            if (!Number.isFinite(v)) {
              continue;
            }
            count++;
            sum += v;
            if (v < min) min = v;
            if (v > max) max = v;
          }

          if (!count) {
            return {
              pos: 1.0,
              neg: -1.0,
              min: 0,
              max: 0,
              mean: 0,
              sigma: 0
            };
          }

          const mean = sum / count;
          let varSum = 0;
          for (let i = 0; i < data.length; i++) {
            const v = data[i];
            if (!Number.isFinite(v)) {
              continue;
            }
            const diff = v - mean;
            varSum += diff * diff;
          }
          const sigma = Math.sqrt(varSum / count) || (max - min) / 6 || 1e-3;

          let pos = clamp(mean + 2.5 * sigma, min, max);
          let neg = clamp(mean - 2.5 * sigma, min, max);

          if (pos <= neg) {
            const mid = (max + min) / 2;
            const span = (max - min) || 1e-3;
            pos = clamp(mid + span * 0.25, min, max);
            neg = clamp(mid - span * 0.25, min, max);
          }

          return { pos, neg, min, max, mean, sigma };
        }

        function formatNumber(value) {
          if (Math.abs(value) >= 0.01 && Math.abs(value) < 1000) {
            return value.toFixed(4);
          }
          return value.toExponential(3);
        }

        function renderVolume(buffer, format, label) {
          try {
            const voldata = new $3Dmol.VolumeData(buffer, format);
            const stats = computeIsoLevels(voldata);
            viewer.removeAllSurfaces();
            viewer.addIsosurface(voldata, {
              isoval: stats.pos,
              color: '#f5c400',
              opacity: 0.85,
              smoothness: 2
            });
            viewer.addIsosurface(voldata, {
              isoval: stats.neg,
              color: '#1f77b4',
              opacity: 0.35,
              smoothness: 2
            });
            viewer.zoomTo();
            viewer.render();
            const descriptor = label || '匿名文件';
            const message = `已加载体数据：${descriptor}\n` +
              `阈值: +${formatNumber(stats.pos)} / ${formatNumber(stats.neg)} ` +
              `(范围 ${formatNumber(stats.min)} ~ ${formatNumber(stats.max)}, σ=${formatNumber(stats.sigma)})`;
            setStatus(message, false);
          } catch (error) {
            setStatus('无法解析体数据：' + error.message, true);
            console.error(error);
          }
        }

        function loadVolumeFromUrl(path, format, label) {
          setStatus('正在加载 ' + label + ' …', false);
          return fetch(path)
            .then(function (response) {
              if (!response.ok) {
                throw new Error('HTTP ' + response.status);
              }
              return response.arrayBuffer();
            })
            .then(function (buffer) {
              renderVolume(buffer, format, label);
              return true;
            })
            .catch(function (error) {
              setStatus('加载失败：' + error.message, true);
              return false;
            });
        }

        function updatePresetSelection(activeButton) {
          document.querySelectorAll('.volume-preset-button').forEach(function (btn) {
            btn.classList.toggle('is-selected', btn === activeButton);
          });
        }

        loadVolumeFromUrl('static/data/sample_map.ccp4', 'ccp4', 'sample_map.ccp4');

        const fileInput = document.getElementById('mrc-file-input');
        const fileName = document.getElementById('mrc-file-name');

        if (fileInput) {
          fileInput.addEventListener('change', function (event) {
            const file = event.target.files && event.target.files[0];
            if (!file) {
              return;
            }
            if (fileName) {
              fileName.textContent = file.name;
            }
            setStatus('正在载入 ' + file.name + ' …', false);
            file.arrayBuffer()
              .then(function (buffer) {
                const format = detectFormat(file.name);
                renderVolume(buffer, format, file.name);
                updatePresetSelection(null);
              })
              .catch(function (error) {
                setStatus('读取文件失败：' + error.message, true);
              });
          });
        }

        document.querySelectorAll('.volume-preset-button').forEach(function (button) {
          button.addEventListener('click', function () {
            const path = button.getAttribute('data-volume-path');
            const format = button.getAttribute('data-volume-format') || detectFormat(path);
            const label = button.getAttribute('data-volume-label') || path.split('/').pop();
            if (fileName) {
              fileName.textContent = label;
            }
            loadVolumeFromUrl(path, format, label).then(function (success) {
              if (success) {
                updatePresetSelection(button);
              }
            });
          });
        });
      });
    })();
  </script>

  <section class="hero is-small">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="column is-full">
          <div class="content">
            <h2 class="title is-3">Pipeline</h2>
            <img src="static/images/pipeline.png" alt="Pipeline diagram summarizing CryoFastAR's pose estimation and reconstruction architecture." class="center-image">
            <div class="content has-text-justified">
              CryoFastAR employs a ViT-Large encoder, a decoder with view integration and updating blocks, and downstream heads for pose regression.
              Training progresses from clean two-view projections to noisy, CTF-augmented multi-view images, and finally to real particle data, ensuring robust generalization. The model processes large batches of views simultaneously, delivering feed-forward pose predictions ready for refinement.
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero is-small" id="results">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="content has-text-centered">
          <h2 class="title is-3">Qualitative Results</h2>
        </div>
        <div class="content">
          <h3 class="title is-4">Synthetic Results</h3>
          <img src="static/images/synthetic_gallery.png" alt="Synthetic reconstructions comparing CryoFastAR with traditional iterative solvers across multiple molecules." class="center-image">
          <p class="has-text-justified">
            CryoFastAR preserves fine structural details across simulated complexes while avoiding the artifacts that iterative pose-bootstrapping methods sometimes introduce. Visual comparisons highlight sharper density recovery for flexible regions and cleaner background suppression on challenging molecules.
          </p>
        </div>
        <div class="content">
          <h3 class="title is-4">Experimental Results</h3>
          <img src="static/images/experimental_spliceosome.png" alt="Qualitative comparison on the experimental spliceosome dataset showing CryoFastAR capturing more complete structures." class="center-image">
          <p class="has-text-justified">
            On the experimental spliceosome dataset, CryoFastAR reconstructs cohesive densities that trace helices and peripheral domains, while iterative baselines struggle with missing or noisy regions. Feed-forward predictions offer a clean starting volume that downstream refinement can further polish.
          </p>
        </div>
      </div>
    </div>
  </section>

  <section class="hero is-small">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="column is-full">
          <div class="content">
            <h2 class="title is-3">Ablations &amp; Training Insights</h2>
            <img src="static/images/ablation.png" alt="Ablation study results showing gains from curriculum stages and architectural choices." class="center-image">
            <div class="content has-text-justified">
              Ablation studies demonstrate that staged training, multi-view integration, and high-capacity encoders collectively reduce rotation and translation errors.
              Removing curriculum steps or view-fusion modules leads to noticeable drops in accuracy, validating the end-to-end design decisions reported in the paper.
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@inproceedings{zhang2025cryofastar,
  author    = {Zhang, Jiakai and Zhou, Shouchen and Dai, Haizhao and Liu, Xinhang and Wang, Peihao and Fan, Zhiwen and Pei, Yuan and Yu, Jingyi},
  title     = {CryoFastAR: Fast Cryo-EM Ab Initio Reconstruction Made Easy},
  booktitle = {Proceedings of the IEEE/CVF International Conference on Computer Vision},
  year      = {2025}
}</code></pre>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
              You are welcome to reuse the source code with attribution. This website is licensed under a
              <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

</body>
</html>
